<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Qu·∫£n l√Ω ƒë∆°n thu·ªëc</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../css/styles.css" />
</head>

<body>
  <div class="page-container d-flex flex-column min-vh-100">
    <!-- Header -->
    <header class="py-3 shadow-sm">
      <div class="container d-flex justify-content-between align-items-center">
        <h1 class="h4 mb-0">üè• B·ªánh vi·ªán ABC</h1>
        <nav class="d-flex align-items-center">
          <a href="index.html" class="nav-link">Trang ch·ªß</a>
          <a href="#" class="nav-link fw-bold text-primary">ƒê∆°n thu·ªëc</a>
        </nav>
      </div>
    </header>

    <!-- Main -->
    <main class="container my-5 flex-fill">
      <h2 class="text-center text-primary mb-4">Danh s√°ch ƒë∆°n thu·ªëc</h2>

      <div class="table-responsive mb-4">
        <table class="table table-bordered table-hover text-center align-middle">
          <thead class="table-light">
            <tr>
              <th>M√£ ƒë∆°n</th>
              <th>B·ªánh nh√¢n</th>
              <th>Ng√†y t·∫°o</th>
              <th>B√°c sƒ©</th>
              <th>Tr·∫°ng th√°i</th>
              <th>H√†nh ƒë·ªông</th>
              <th>Chi ti·∫øt</th>
            </tr>
          </thead>
          <tbody id="prescriptionTableBody">
            <!-- Render ƒë·ªông -->
          </tbody>
        </table>
      </div>
    </main>

    <!-- Modal chi ti·∫øt -->
    <div class="modal fade" id="prescriptionModal" tabindex="-1" aria-labelledby="prescriptionModalLabel"
      aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="prescriptionModalLabel">Chi ti·∫øt ƒë∆°n thu·ªëc</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
          </div>
          <div class="modal-body">
            <div id="prescriptionDetail">
              <!-- N·ªôi dung chi ti·∫øt render ·ªü ƒë√¢y -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-4 mt-5">
      <div class="container">
        <p class="mb-1">¬© 2025 B·ªánh vi·ªán ABC - H·ªá th·ªëng qu·∫£n l√Ω b·ªánh vi·ªán</p>
        <small>Li√™n h·ªá: 0123 456 789 | Email: support@benhvienabc.vn</small>
      </div>
    </footer>
  </div>

  <!-- Script -->
  <script>
    const prescriptions = [
      {
        id: 'RX20250001',
        patient: 'Nguy·ªÖn VƒÉn A',
        date: '2025-07-10',
        doctor: 'BS. Hoa',
        status: 'Ch∆∞a c·∫•p',
        diagnosis: 'Vi√™m h·ªçng',
        notes: 'U·ªëng sau ƒÉn s√°ng',
        drugs: ['Paracetamol 500mg - 10 vi√™n', 'Vitamin C - 5 vi√™n']
      },
      {
        id: 'RX20250002',
        patient: 'Tr·∫ßn Th·ªã B',
        date: '2025-07-11',
        doctor: 'BS. H√πng',
        status: 'H·ªßy',
        diagnosis: 'C·∫£m c√∫m',
        notes: '',
        drugs: ['Decolgen - 6 vi√™n']
      },
      {
        id: 'RX20250003',
        patient: 'Ph·∫°m VƒÉn C',
        date: '2025-07-12',
        doctor: 'BS. Minh',
        status: 'ƒê√£ c·∫•p',
        diagnosis: 'Ho nh·∫π',
        notes: 'U·ªëng s√°ng t·ªëi',
        drugs: ['Codein - 3 vi√™n']
      }
    ];

    const tableBody = document.getElementById("prescriptionTableBody");
    const detailContainer = document.getElementById("prescriptionDetail");

    function renderTable() {
      tableBody.innerHTML = "";

      prescriptions.forEach(p => {
        const row = document.createElement("tr");

        const isDispensed = p.status === "ƒê√£ c·∫•p";

        row.innerHTML = `
          <td>${p.id}</td>
          <td>${p.patient}</td>
          <td>${p.date}</td>
          <td>${p.doctor}</td>
          <td>${p.status}</td>
          <td>
            <button class="btn btn-${isDispensed ? "danger" : "success"} btn-sm" onclick="toggleDispense('${p.id}')">
              ${isDispensed ? "H·ªßy c·∫•p" : "C·∫•p thu·ªëc"}
            </button>
          </td>
          <td>
            <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#prescriptionModal" onclick="viewDetail('${p.id}')">Chi ti·∫øt</button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }

    function toggleDispense(id) {
      const prescription = prescriptions.find(p => p.id === id);
      if (!prescription) return;

      if (prescription.status === "ƒê√£ c·∫•p") {
        prescription.status = "H·ªßy";
      } else {
        prescription.status = "ƒê√£ c·∫•p";
      }

      renderTable();
      // TODO: G·ª≠i thay ƒë·ªïi v·ªÅ backend n·∫øu c·∫ßn
    }

    function viewDetail(id) {
      const p = prescriptions.find(p => p.id === id);

      detailContainer.innerHTML = `
        <p><strong>M√£ ƒë∆°n:</strong> ${p.id}</p>
        <p><strong>B·ªánh nh√¢n:</strong> ${p.patient}</p>
        <p><strong>Ng√†y k√™:</strong> ${p.date}</p>
        <p><strong>Ch·∫©n ƒëo√°n:</strong> ${p.diagnosis}</p>
        <p><strong>Danh s√°ch thu·ªëc:</strong></p>
        <ul>${p.drugs.map(d => `<li>${d}</li>`).join("")}</ul>
        <p><strong>Ghi ch√∫:</strong> ${p.notes || "Kh√¥ng c√≥"}</p>
        <p><strong>Tr·∫°ng th√°i hi·ªán t·∫°i:</strong> ${p.status}</p>
      `;
    }

    renderTable();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
